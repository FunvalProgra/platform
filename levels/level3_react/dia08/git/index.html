<!doctype html><html lang=es dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="es"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="rgb(255,255,255)"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Enlazando Paginas Con Next.js &#183; Funval International</title><meta name=title content="Enlazando Paginas Con Next.js &#183; Funval International"><meta name=description content="Enlazando páginas # Para obtener una navegación fluida entre las páginas de nuestra aplicación, necesitamos importar el componente Link y usarlo de la siguiente manera:"><link rel=canonical href=https://funvalprogra.github.io/platform/levels/level3_react/dia08/git/><link type=text/css rel=stylesheet href=/platform/css/main.bundle.min.f2df16eaa2254cb2cbdb50c88227e9e648d2d03928ce0db7a6b45b9aae2b5b590d1835b5a0b2a6fef3ccf909200384081f18673a10fc046d258e163b23f4eca9.css integrity="sha512-8t8W6qIlTLLL21DIgifp5kjS0Dkozg23prRbmq4rW1kNGDW1oLKm/vPM+QkgA4QIHxhnOhD8BG0ljhY7I/TsqQ=="><script type=text/javascript src=/platform/js/appearance.min.1e44157c1e51b46341ce2c94716dd3dd1ef30c28e7d1c9f3b9db80877bfe72bc66b00d8a662f317840016acbed93c5f18c3d9268c8b957021ee74d0b04adf6c5.js integrity="sha512-HkQVfB5RtGNBziyUcW3T3R7zDCjn0cnzuduAh3v+crxmsA2KZi8xeEABasvtk8XxjD2SaMi5VwIe500LBK32xQ=="></script>
<script defer type=text/javascript id=script-bundle src=/platform/js/main.bundle.min.9947db70e5b36e741e53f8531bd734741b3fc7a688f7b5d749fc5433c48efc252f47bdf44e471570a550fc051b87712799014040e6349b38d64448b94e84e45a.js integrity="sha512-mUfbcOWzbnQeU/hTG9c0dBs/x6aI97XXSfxUM8SO/CUvR730TkcVcKVQ/AUbh3EnmQFAQOY0mzjWREi5ToTkWg==" data-copy=Copiar data-copied=Copiado></script>
<link rel=apple-touch-icon sizes=180x180 href=/platform/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/platform/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/platform/favicon-16x16.png><link rel=manifest href=/platform/site.webmanifest><meta property="og:title" content="Enlazando Paginas Con Next.js"><meta property="og:description" content="Enlazando páginas # Para obtener una navegación fluida entre las páginas de nuestra aplicación, necesitamos importar el componente Link y usarlo de la siguiente manera:"><meta property="og:type" content="article"><meta property="og:url" content="https://funvalprogra.github.io/platform/levels/level3_react/dia08/git/"><meta property="article:section" content="levels"><meta property="article:published_time" content="2023-03-12T11:50:06-06:00"><meta property="article:modified_time" content="2023-03-12T11:50:06-06:00"><meta property="og:site_name" content="Funval International"><meta name=twitter:card content="summary"><meta name=twitter:title content="Enlazando Paginas Con Next.js"><meta name=twitter:description content="Enlazando páginas # Para obtener una navegación fluida entre las páginas de nuestra aplicación, necesitamos importar el componente Link y usarlo de la siguiente manera:"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Levels","name":"Enlazando Paginas Con Next.js","headline":"Enlazando Paginas Con Next.js","abstract":"Enlazando páginas # Para obtener una navegación fluida entre las páginas de nuestra aplicación, necesitamos importar el componente Link y usarlo de la siguiente manera:","inLanguage":"es","url":"https:\/\/funvalprogra.github.io\/platform\/levels\/level3_react\/dia08\/git\/","author":{"@type":"Person","name":""},"copyrightYear":"2023","dateCreated":"2023-03-12T11:50:06-06:00","datePublished":"2023-03-12T11:50:06-06:00","dateModified":"2023-03-12T11:50:06-06:00","mainEntityOfPage":"true","wordCount":"2551"}]</script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Ir al contenido</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral print:hidden sm:py-10"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><h1>Funval International</h1></div></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Enlazando Paginas Con Next.js</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><span title="Tiempo de lectura">12 mins</span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Tabla de contenido</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#enlazando-páginas>Enlazando páginas</a><ul><li><a href=#cambios-en-el-enrutador-nextjs>Cambios en el enrutador Next.js</a><ul><li><a href=#más-concretamente-aquí-hay-un-ejemplo>Más concretamente, aquí hay un ejemplo:</a></li></ul></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-3xl grow"><h1 id=enlazando-páginas class="relative group">Enlazando páginas <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#enlazando-p%c3%a1ginas aria-label=Ancla>#</a></span></h1><p>Para obtener una navegación fluida entre las páginas de nuestra aplicación, necesitamos importar el componente Link y usarlo de la siguiente manera:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Link</span> <span class=nx>from</span> <span class=s2>&#34;next/link&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>Home</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>ul</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>li</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>Link</span> <span class=nx>href</span><span class=o>=</span><span class=s2>&#34;/&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>&lt;</span><span class=nx>a</span><span class=o>&gt;</span><span class=nx>Home</span><span class=o>&lt;</span><span class=err>/a&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=err>/Link&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=err>/li&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>li</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>Link</span> <span class=nx>href</span><span class=o>=</span><span class=s2>&#34;/perfil&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>&lt;</span><span class=nx>a</span><span class=o>&gt;</span><span class=nx>Mi</span> <span class=nx>perfil</span><span class=o>&lt;</span><span class=err>/a&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=err>/Link&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=err>/li&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>li</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>Link</span> <span class=nx>href</span><span class=o>=</span><span class=s2>&#34;/blog/post/hola-mundo&#34;</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>&lt;</span><span class=nx>a</span><span class=o>&gt;</span><span class=nx>Post</span><span class=o>&lt;</span><span class=err>/a&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=err>/Link&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=err>/li&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/ul&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>pages/index.js
En el ejemplo anterior podemos observar que hay múltiples enlaces, cada uno cuenta con un componente Link que recibe una propiedad href indicando la ruta a la que dirige. Link envuelve un elemento Anchor a que contiene el texto de nuestro enlace.
Enlazando Rutas Dinámicas
También puedes utilizar interpolación para crear la ruta, lo que resulta útil para los segmentos de ruta dinámicos. Por ejemplo, para mostrar una lista de posts que se han pasado al componente como propiedad:
import Link from &ldquo;next/link&rdquo;;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>Posts</span><span class=p>({</span> <span class=nx>posts</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>ul</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>posts</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>post</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>li</span> <span class=nx>key</span><span class=o>=</span><span class=p>{</span><span class=nx>post</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>&lt;</span><span class=nx>Link</span> <span class=nx>href</span><span class=o>=</span><span class=p>{</span><span class=sb>`/blog/post/</span><span class=si>${</span><span class=nx>post</span><span class=p>.</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;</span><span class=nx>a</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>post</span><span class=p>.</span><span class=nx>titulo</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/a&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>&lt;</span><span class=err>/Link&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=err>/li&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>))}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/ul&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>O usando un objeto URL:
import Link from &ldquo;next/link&rdquo;;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=nx>Posts</span><span class=p>({</span> <span class=nx>posts</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>ul</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>posts</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>post</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>li</span> <span class=nx>key</span><span class=o>=</span><span class=p>{</span><span class=nx>post</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>&lt;</span><span class=nx>Link</span>
</span></span><span class=line><span class=cl>            <span class=nx>href</span><span class=o>=</span><span class=p>{{</span>
</span></span><span class=line><span class=cl>              <span class=nx>pathname</span><span class=o>:</span> <span class=s2>&#34;/blog/post/[id]&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nx>query</span><span class=o>:</span> <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=nx>post</span><span class=p>.</span><span class=nx>id</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>}}</span>
</span></span><span class=line><span class=cl>          <span class=o>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;</span><span class=nx>a</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>post</span><span class=p>.</span><span class=nx>titulo</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/a&gt;</span>
</span></span><span class=line><span class=cl>          <span class=o>&lt;</span><span class=err>/Link&gt;</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=err>/li&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>))}</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/ul&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Como puedes observar, en el código anterior utilizamos el hook useRouter de Next.js para acceder al objeto router, dicho objeto contiene propiedades muy útiles, las partes dinámicas de cada ruta se almacenan en router.query.
Como se mencionó anteriormente, Next.js utiliza un enfoque basado en páginas para crear rutas. Concretamente, esto significa que en cada proyecto de Next.js existe una pagescarpeta. Dentro de esta carpeta especial, cada archivo y carpeta constituye una nueva ruta.
En la pagescarpeta, la primera ruta raíz es index.js, que representa la página de inicio en la /URL. También puede nombrar su archivo y crear una ruta estática (es decir, about.jspara la /aboutruta).
De manera similar, las carpetas también se pueden usar para crear rutas anidadas. Por ejemplo, crear una carpeta con un nombre supporty un archivo dentro faq.jscreará la ruta /support/faq.
Aquí hay un diagrama para ilustrar mejor esto:
Las rutas dinámicas también son compatibles. Al poner corchetes en el nombre de su archivo o carpeta, puede crear una ruta dinámica. Por ejemplo, /blog/[article-id].jsadmitirá múltiples rutas como /blog/1, /blog/nextjs-dynamic-routing, etc.
Limitaciones del enrutador Next.js
Desafortunadamente, este enfoque tiene una limitación importante. Es decir, a pesar de que las rutas anidadas comparten una ruta principal, no puede compartir el estado o el diseño entre ellas.
Por ejemplo, tome la autenticación. En React, utilizando la biblioteca de enrutador de reacción , puede crear rutas personalizadas. Por ejemplo, podría crear una ruta protegida para verificar si el usuario ha iniciado sesión. Si el usuario no ha iniciado sesión, la ruta lo redirigirá, por ejemplo, a la página de inicio de sesión o registro. Luego, puede asignar esta ruta protegida a cualquier ruta /authenticationen su enrutador. Al hacer esto, las rutas anidadas no tienen que preocuparse por la autenticación, ya que la ruta principal se encargará de ello.
Desafortunadamente, este escenario no es posible con Next.js. Puede crear un componente de ruta personalizado, pero tendrá que ajustarlo alrededor de cada página protegida individualmente.
El mismo problema se aplica a los diseños. Si su aplicación tiene un tablero, varias páginas compartirán un diseño similar (navegación, pie de página, etc.). Tal como está, la única forma de aplicar un diseño a varias páginas a la vez es hacerlo en el nivel de la aplicación. Este diseño se aplicaría a toda su aplicación. Desafortunadamente, si tiene varios diseños, debe definirlos por página.</p><h2 id=cambios-en-el-enrutador-nextjs class="relative group">Cambios en el enrutador Next.js <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cambios-en-el-enrutador-nextjs aria-label=Ancla>#</a></span></h2><p>Sabiendo todo esto, el equipo de Vercel decidió corregir estas limitaciones.
Cambios en la creación de rutas
Para empezar, de manera similar a la pagescarpeta, habrá una nueva carpeta llamada app. Esto es para proporcionar compatibilidad con versiones anteriores y permitir que los desarrolladores migren lentamente al nuevo enrutador.
Entonces, la estructura de carpetas seguirá determinando nuevas rutas. Esto significa que una dashboardcarpeta dentro appestaría vinculada a las /dashboardrutas. Sin embargo, donde se pone interesante son los archivos dentro de esas rutas.
El enrutador anterior asumía que cada archivo dentro de /pagesera una nueva ruta. Esto, por cierto, hizo que los desarrolladores separaran sus componentes React de páginas y no páginas (es decir, Navbar, Header, Footer). Poner un archivo como Navbar.jscon la página de inicio, también conocido como /pages/index.js, habría hecho que el enrutador creyera que Navbares una nueva ruta y no un simple componente secundario. Como resultado, muchos desarrolladores tuvieron que crear una componentscarpeta y separar sus diferentes componentes.
Sin embargo, el nuevo enrutador asume que cada archivo NO es una ruta a menos que se indique explícitamente. Para crear una nueva ruta, por lo tanto, debe crear una page.jsdentro de la carpeta.
Por lo tanto, nuestro ejemplo de proyecto anterior se vería así con el nuevo enrutador:
Las rutas dinámicas también son compatibles. Con este nuevo formato, para tener una /blog/[article-id]URL por ejemplo, necesitarías una /app/blog/[article-id]/page.jsestructura de carpetas.
En resumen, aquí hay una estructura de carpetas y sus rutas correspondientes:
/app/blog/[article-id]/page.js→/blog/[article-id]
/app/blog/[category-id]/page.js→/blog/[category-id]
/app/blog/[category-id]/[article-id]/page.js→/blog/[category-id]/[article-id]
Diseños anidados
Los diseños también recibieron una actualización.
Anteriormente, podía crear diseños en un archivo separado y luego importar el diseño a su página. Por ejemplo, aquí hay una página de tablero:</p><pre><code>import DashboardLayout from '../components/DashboardLayout'    export default function DashboardPage() {      /* The content for your dashboard page */    }    DashboardPage.getLayout = function getLayout(page) {      return (        &lt;DashboardLayout&gt;          {page}        &lt;/DashboardLayout&gt;      )    }
</code></pre><p>Puede importar varios diseños a su página si necesita anidarlos. Sin embargo, dado que esto se hace por página, cada página anidada en su tablero tendría que importar los diseños y anidarlos.
¡Afortunadamente, esto está cambiando! Con el nuevo enrutador, podrá especificar un diseño para la página de su tablero y cualquier página anidada recibirá automáticamente este diseño. Todo lo que tiene que hacer es crear un layout.jsarchivo en la carpeta para que este diseño se aplique a todas las rutas en esta carpeta.</p><h3 id=más-concretamente-aquí-hay-un-ejemplo class="relative group">Más concretamente, aquí hay un ejemplo: <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#m%c3%a1s-concretamente-aqu%c3%ad-hay-un-ejemplo aria-label=Ancla>#</a></span></h3><p>En este ejemplo, layout.jsse creó un archivo en el nivel raíz, también conocido como en la appcarpeta. Este diseño se aplica automáticamente a cualquier ruta en la aplicación.
Esta aplicación también tiene dos secciones: tablero y soporte. Dado que cada uno de estos posee su estilo, layout.jsse crea un archivo para aplicar el estilo específico para sus rutas. Además del diseño raíz, esto significa que cualquier ruta debajo /dashboardrecibirá el diseño de la aplicación y el del tablero.
Como resultado, ya no tiene que especificar qué diseño usa, ya que los archivos pages.jslo hacen automáticamente .layout.js
A diferencia del enrutador actual de Next.js, que solo le permitía obtener datos a nivel de página, también podrá obtener datos de los diseños. Podrá usar getStaticPropsy getServerPropsrecuperar datos y construir su diseño.
Como resultado, sus /dashboardpáginas podrán obtener datos de múltiples componentes (el diseño de la aplicación, el diseño del tablero y la página misma).</p><p>Cómo crear un HOC (componente de orden superior) que puede redirigir condicionalmente a un usuario en función de su estado de inicio o cierre de sesión.
En Next.js, de forma predeterminada, todas sus rutas se tratan de la misma manera.
Si bien su aplicación específica puede incluir páginas o rutas que están destinadas solo para usuarios que iniciaron sesión, Next.js no proporciona una forma de aislar estas páginas en función del estado de autenticación de un usuario.</p><p>Esto es de esperar ya que Next.js está diseñado para manejar un conjunto de tareas simple y bien definido. Si bien se puede usar como front-end para una aplicación, como en el repetitivo Next.js de CheatCode, tradicionalmente se usa para generar sitios de marketing estáticos o sitios respaldados por un CMS sin cabeza.
Afortunadamente, resolver este problema no es demasiado complejo. Para solucionarlo, vamos a implementar dos componentes:
authenticatedRouteque será una función que devuelve un componente React envuelto con una verificación condicional del estado de autenticación del usuario y una redirección si un usuario no está disponible.
publicRouteque será una función que devuelve un componente React envuelto con una verificación condicional para el estado de autenticación del usuario y una redirección si un usuario está presente.
Implementación de un componente de ruta autenticado
Primero, construyamos el esqueleto de nuestro HOC y discutamos cómo va a funcionar:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=err>/components/AuthenticatedRoute/index.js</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>authenticatedRoute</span> <span class=o>=</span> <span class=p>(</span><span class=nx>Component</span> <span class=o>=</span> <span class=kc>null</span><span class=p>,</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=c1>// We&#39;ll handle wrapping the component here.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>authenticatedRoute</span><span class=p>;</span>
</span></span></code></pre></div><p>Aquí, exportamos una función simple de JavaScript que toma dos argumentos: React Componentcomo el primer argumento y un objeto de optionscomo el segundo. representa el Componentcomponente de la página protegida que queremos representar condicionalmente.
Cuando vayamos a poner esto en uso, haremos algo como esto:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=sr>/pages/</span><span class=o>&lt;</span><span class=nx>algunapágina</span><span class=o>&gt;</span><span class=err>/index.js</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>authenticatedRoute</span> <span class=nx>from</span> <span class=s1>&#39;../../components/AuthenticatedRoute&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MyComponent</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>[...]</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>authenticatedRoute</span><span class=p>(</span><span class=nx>MyComponent</span><span class=p>,</span> <span class=p>{</span> <span class=nx>pathAfterFailure</span><span class=o>:</span> <span class=s1>&#39;/login&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>En</span> <span class=nx>el</span> <span class=nx>futuro</span><span class=p>,</span> <span class=nx>completemos</span> <span class=nx>nuestro</span> <span class=nx>HOC</span> <span class=nx>con</span> <span class=nx>el</span> <span class=nx>componente</span> <span class=nx>contenedor</span> <span class=nx>principal</span><span class=o>:</span>
</span></span><span class=line><span class=cl><span class=err>/components/AuthenticatedRoute/index.js</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>authenticatedRoute</span> <span class=o>=</span> <span class=p>(</span><span class=nx>Component</span> <span class=o>=</span> <span class=kc>null</span><span class=p>,</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>class</span> <span class=nx>AuthenticatedRoute</span> <span class=kr>extends</span> <span class=nx>React</span><span class=p>.</span><span class=nx>Component</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>loading</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>loading</span> <span class=p>}</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>loading</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=o>&lt;</span><span class=nx>Component</span> <span class=p>{...</span><span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>}</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>AuthenticatedRoute</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>authenticatedRoute</span><span class=p>;</span>
</span></span></code></pre></div><p>Aquí, hemos llenado authenticatedRouteel cuerpo de nuestra función con un componente React basado en clases. La idea aquí es que queremos utilizar el estado y, a continuación, la componentDidMountfunción de la clase para que podamos decidir si queremos representar el pasado Componento redirigir al usuario fuera de él.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=err>/components/AuthenticatedRoute/index.js</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Router</span> <span class=nx>from</span> <span class=s2>&#34;next/router&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>authenticatedRoute</span> <span class=o>=</span> <span class=p>(</span><span class=nx>Component</span> <span class=o>=</span> <span class=kc>null</span><span class=p>,</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>class</span> <span class=nx>AuthenticatedRoute</span> <span class=kr>extends</span> <span class=nx>React</span><span class=p>.</span><span class=nx>Component</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>loading</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>componentDidMount</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>.</span><span class=nx>isLoggedIn</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>setState</span><span class=p>({</span> <span class=nx>loading</span><span class=o>:</span> <span class=kc>false</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>Router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>options</span><span class=p>.</span><span class=nx>pathAfterFailure</span> <span class=o>||</span> <span class=s2>&#34;/login&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>loading</span> <span class=p>}</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>loading</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=o>&lt;</span><span class=nx>Component</span> <span class=p>{...</span><span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>}</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>AuthenticatedRoute</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>authenticatedRoute</span><span class=p>;</span>
</span></span></code></pre></div><p>Ahora, con nuestro componentDidMountagregado, podemos ver implementado nuestro comportamiento principal. En el interior, todo lo que queremos saber es &ldquo;¿hay un usuario conectado o no?&rdquo; Si hay un usuario conectado, queremos decir &ldquo;adelante y renderice el pasado Component&rdquo;. Podemos ver que esto tiene lugar en el render()método del AuthenticatedRoutecomponente.
Aquí, estamos diciendo, siempre que loadingsea true, simplemente devuelva un vacío<div>(o no muestre nada al usuario). Si no estamos cargando, simplemente ejecute la returndeclaración en la parte inferior del archivo render().
Lo que esto logra es decir &ldquo;hasta que sepamos que tenemos un usuario conectado, no mostrar nada, y si tenemos un usuario conectado, mostrarles la página a la que intentan acceder&rdquo;.
De vuelta en componentDidMount()la elsedeclaración, decimos &ldquo;bien, no parece que el usuario haya iniciado sesión, así que vamos a redirigirlo&rdquo;. Para hacer la redirección en este ejemplo, estamos usando el enrutador integrado Next.js para hacer la redirección por nosotros, pero puede usar cualquier enrutador JavaScript o React que desee (por ejemplo, si estuviéramos usando React Router, haría this.props.history.push(options.pathAfterFailure || &lsquo;/login&rsquo;)_
¿Tener sentido? Entonces, si tenemos un usuario, muéstrale el componente. Si no tenemos un usuario, redirigirlo a otra ruta.
Determinar el estado de inicio de sesión
Ahora, técnicamente hablando, esto es todo lo que tenemos que hacer. Pero es posible que se pregunte &ldquo;¿cómo sabemos si el usuario ha iniciado sesión?&rdquo; Aquí es donde entra en juego su propia aplicación. En este ejemplo, estamos usando CheatCode Next.js Boilerplate que depende de que un usuario autenticado (si está disponible) esté presente en una tienda Redux global.
Para hacer todo esto un poco más concreto, echemos un vistazo a esa configuración ahora:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=err>/components/AuthenticatedRoute/index.js</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Router</span> <span class=nx>from</span> <span class=s2>&#34;next/router&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>connect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react-redux&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>authenticatedRoute</span> <span class=o>=</span> <span class=p>(</span><span class=nx>Component</span> <span class=o>=</span> <span class=kc>null</span><span class=p>,</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>class</span> <span class=nx>AuthenticatedRoute</span> <span class=kr>extends</span> <span class=nx>React</span><span class=p>.</span><span class=nx>Component</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>loading</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>componentDidMount</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>.</span><span class=nx>isLoggedIn</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>setState</span><span class=p>({</span> <span class=nx>loading</span><span class=o>:</span> <span class=kc>false</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>Router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>options</span><span class=p>.</span><span class=nx>pathAfterFailure</span> <span class=o>||</span> <span class=s2>&#34;/login&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>loading</span> <span class=p>}</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>loading</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=o>&lt;</span><span class=nx>Component</span> <span class=p>{...</span><span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>}</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>connect</span><span class=p>((</span><span class=nx>state</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>isLoggedIn</span><span class=o>:</span> <span class=nx>state</span><span class=o>?</span><span class=p>.</span><span class=nx>authenticated</span> <span class=o>&amp;&amp;</span> <span class=o>!!</span><span class=nx>state</span><span class=o>?</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}))(</span><span class=nx>AuthenticatedRoute</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>authenticatedRoute</span><span class=p>;</span>
</span></span></code></pre></div><p>El gran cambio que hemos hecho aquí es importar el connect()método del react-reduxpaquete (ya instalado en el repetitivo) y luego llamar a esa función, pasándole una mapStateToPropsfunción y luego envolviéndola alrededor de nuestro componente. Para ser claros, esta parte:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=err>/components/AuthenticatedRoute/index.js</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=nx>connect</span><span class=p>((</span><span class=nx>state</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>isLoggedIn</span><span class=o>:</span> <span class=nx>state</span><span class=o>?</span><span class=p>.</span><span class=nx>authenticated</span> <span class=o>&amp;&amp;</span> <span class=o>!!</span><span class=nx>state</span><span class=o>?</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}))(</span><span class=nx>AuthenticatedRoute</span><span class=p>);</span>
</span></span></code></pre></div><p>Aquí, la función que pasamos como primer argumento connect()es la mapStateToPropsfunción (como se nombra en la react-reduxdocumentación). Esta función toma en cuenta el estado global actual de la aplicación proporcionada por el código modelo <reduxprovider>de /pages/_app.jsCheatCode Next.js.
Al usar ese estado, como su nombre lo indica, asigna ese estado a un componente de React que se transmitirá a nuestro <authenticatedroute>componente definido justo encima.
Si miramos de cerca, aquí, estamos configurando un accesorio llamado isLoggedIn, verificando si el authenticatedvalor en nuestro estado es truey si tenemos o no un userobjeto en estado. si lo hacemos? ¡El usuario ha iniciado sesión! Si no, isLoggedInes falso.
Si mira hacia atrás en la componentDidMount()función, aquí es donde estamos poniendo isLoggedInen uso el nuevo accesorio.</p><p>Uso de otras fuentes de autenticación
Si no está utilizando CheatCode Next.js Boilerplate, la forma en que llega al estado autenticado de su usuario depende de su aplicación. Un ejemplo rápido y sucio de usar otra API se vería así:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Router</span> <span class=nx>from</span> <span class=s2>&#34;next/router&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>connect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react-redux&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>myAuthenticationAPI</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;my-authentication-api&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>authenticatedRoute</span> <span class=o>=</span> <span class=p>(</span><span class=nx>Component</span> <span class=o>=</span> <span class=kc>null</span><span class=p>,</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>class</span> <span class=nx>AuthenticatedRoute</span> <span class=kr>extends</span> <span class=nx>React</span><span class=p>.</span><span class=nx>Component</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>loading</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>componentDidMount</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>isLoggedIn</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>myAuthenticationAPI</span><span class=p>.</span><span class=nx>isLoggedIn</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>isLoggedIn</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>setState</span><span class=p>({</span> <span class=nx>loading</span><span class=o>:</span> <span class=kc>false</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>Router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>options</span><span class=p>.</span><span class=nx>pathAfterFailure</span> <span class=o>||</span> <span class=s2>&#34;/login&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>loading</span> <span class=p>}</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>loading</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=o>&lt;</span><span class=nx>Component</span> <span class=p>{...</span><span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>}</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>AuthenticatedRoute</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>authenticatedRoute</span><span class=p>;</span>
</span></span></code></pre></div><p>En este ejemplo, casi todo es idéntico, pero en lugar de anticipar un valor de autenticación proveniente de una tienda de Redux, simplemente llamamos a nuestra API de autenticación (por ejemplo, Firebase) directamente, confiando en el valor de retorno de esa llamada como nuestro isLoggedInestado.</p><p>Implementar un componente de ruta pública
Ahora, algunas buenas noticias: nuestro publicRoutecomponente es idéntico al que vimos anteriormente con un pequeño cambio:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=err>/components/PublicRoute/index.js</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span> <span class=nx>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Router</span> <span class=nx>from</span> <span class=s2>&#34;next/router&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>connect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;react-redux&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>publicRoute</span> <span class=o>=</span> <span class=p>(</span><span class=nx>Component</span> <span class=o>=</span> <span class=kc>null</span><span class=p>,</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>class</span> <span class=nx>PublicRoute</span> <span class=kr>extends</span> <span class=nx>React</span><span class=p>.</span><span class=nx>Component</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>loading</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>componentDidMount</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>.</span><span class=nx>isLoggedIn</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>setState</span><span class=p>({</span> <span class=nx>loading</span><span class=o>:</span> <span class=kc>false</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>Router</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>options</span><span class=p>.</span><span class=nx>pathAfterFailure</span> <span class=o>||</span> <span class=s2>&#34;/documents&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>loading</span> <span class=p>}</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>loading</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>&lt;</span><span class=nx>div</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=o>&lt;</span><span class=nx>Component</span> <span class=p>{...</span><span class=k>this</span><span class=p>.</span><span class=nx>props</span><span class=p>}</span> <span class=o>/&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>connect</span><span class=p>((</span><span class=nx>state</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>isLoggedIn</span><span class=o>:</span> <span class=nx>state</span><span class=o>?</span><span class=p>.</span><span class=nx>authenticated</span> <span class=o>&amp;&amp;</span> <span class=o>!!</span><span class=nx>state</span><span class=o>?</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}))(</span><span class=nx>PublicRoute</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>publicRoute</span><span class=p>;</span>
</span></span></code></pre></div><p>¿Puedes distinguirlo? Arriba en el componentDidMounthemos agregado una !para decir &ldquo;si el usuario no ha iniciado sesión, continúe y renderice el componente. Si está conectado, rediríjalo&rdquo;.
Literalmente la lógica inversa a nuestra authenticatedRoute. El punto aquí es que queremos usar el publicRoute()componente en rutas similares /logino /signuppara redirigir a los usuarios ya autenticados fuera de esas páginas. Esto asegura que no tengamos problemas con la base de datos más tarde, como usuarios duplicados o sesiones de múltiples usuarios.</p></div></section><footer class="pt-8 max-w-3xl print:hidden"><div class=flex><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div></footer></article><div class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Ir arriba" title="Ir arriba">&uarr;</a></div></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2023</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Desarrollada con <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher type=button><div class="flex items-center justify-center w-12 h-12 dark:hidden" title="Cambiar a modo oscuro"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden w-12 h-12 dark:flex" title="Cambiar a modo claro"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div></footer></div></body></html>